# 画面遷移設計書（Liquid Glass デザインコンセプト版）

## 1. 概要

本書は、iOS 26の「Liquid Glass」コンセプトに基づき、MVP（Minimum Viable Product）の画面構成と遷移フローを定義します。2025年9月14日時点の実装は存在しないため、本書が最初の設計図となります。

### 1.1 Liquid Glass デザインコンセプト

- **基本思想**: UI要素が液体のように滑らかに、そしてガラスのように透明感を持って振る舞うデザイン。
- **ビジュアル**:
    - **半透明レイヤー (Glassmorphism)**: すりガラスのような半透明のレイヤーを多用し、背景の色彩がぼけて透けることで、奥行きとコンテキストを表現します。
    - **光沢感 (Glossy)**: UI要素の表面には、光源を意識したハイライトや、内側から発光するような光沢感を加え、リッチな質感を生み出します。
    - **流体アニメーション (Fluid Animation)**: 画面遷移や要素の表示/非表示は、液体が流れるような、または水滴が合体・分裂するような、滑らかで物理法則に基づいたアニメーションで表現します。
- **インタラクション**:
    - **波紋エフェクト**: タップした要素を中心に、水面に広がるような波紋エフェクトを追加します。
    - **弾性スクロール**: スクロールには、ゴムや液体のような弾力性を持たせ、慣性が働く自然な動きを追求します。

## 2. アプリ構成概要

### 2.1 技術基盤
- **フレームワーク**: SwiftUI + Swift 6.1
- **データ管理**: SwiftData（ローカルキャッシュ）
- **ナビゲーション**: NavigationView + TabView
- **状態管理**: @StateObject + @Published

### 2.2 全体構成
```
MatchingAppApp
└── TabRootView（タブベースナビゲーション）
    ├── HomeView（掲示板）
    ├── ChatListView（チャット一覧）
    └── SettingsView（設定）
```

## 3. 画面構成詳細

### 3.1 タブルートビュー (TabRootView)
- **デザイン**:
    - 背景はアプリのテーマカラーがぼんやりと動くダイナミックな壁紙。
    - タブバー自体が半透明のガラスパネルになっており、下のコンテンツが透けて見えます。
    - 選択中のタブアイコンは、内側から発光するような光沢感を持ちます。
- **実装構成**:
    - **ホームタブ**: `HomeView()` - `house` アイコン
    - **チャットタブ**: `ChatListView()` - `bubble.left.and.bubble.right` アイコン
    - **設定タブ**: `SettingsView()` - `gear.shape` アイコン
- **遷移**: タブタップで画面が液体のように溶け合いながら切り替わります（Cross-fade + slight scale）。

---

### 3.2 ホーム画面（掲示板機能 - HomeView）

#### 3.2.1 画面構成
```
┌─────────────────────────────────────┐
│ 掲示板                              │ ← ガラス調ヘッダー
├─────────────────────────────────────┤
│ 💧                                  │ ← 流体的なプルリフレッシュ
│ ┌─────────────────────────────────┐ │
│ │ "今夜飲める方募集"               │ │ ← ガラスカード
│ │ 👤 田中さん 📍 東京               │ │
│ └─────────────────────────────────┘ │
│ ┌─────────────────────────────────┐ │
│ │ "カフェでお話しませんか"          │ │
│ │ 👤 佐藤さん 📍 大阪               │ │
│ └─────────────────────────────────┘ │
│                                     │
│               [ + ]                 │ ← 光沢のあるFAB
└─────────────────────────────────────┘
```
- **デザイン**:
    - **ヘッダー**: 半透明のガラスパネル。スクロールすると背景に溶け込むように透明度が変化します。
    - **投稿カード**: 縁が光沢を帯びたガラスカード。カード自体が半透明で、背景のダイナミックな壁紙がぼやけて見えます。タップするとカードが液体のように波打ち、詳細画面に遷移します。
    - **FAB (Floating Action Button)**: 新規投稿用のボタン。水滴のような丸みを帯びた光沢のあるデザイン。タップすると波紋が広がります。
    - **プルリフレッシュ**: 標準のインジケーターではなく、画面上部から液体が滴り、それが波紋を広げて消えることでリフレッシュを表現します。

#### 3.2.2 画面遷移
- **投稿詳細へ**: `HomeView` → `NavigationLink` → `PostDetailView`
    - トリガー: 投稿カードタップ。カードが液体のように変形しながら詳細画面に遷移します。
- **新規投稿へ**: `HomeView` → `Sheet` → `CreatePostView`
    - トリガー: FABタップ。下からガラスパネルが滑らかにせり上がってきます。

---

### 3.3 チャット一覧画面 (ChatListView) - 新規設計

#### 3.3.1 画面構成
```
┌─────────────────────────────────────┐
│ チャット                            │ ← ガラス調ヘッダー
├─────────────────────────────────────┤
│ 💧                                  │ ← 流体的なプルリフレッシュ
│ ┌─────────────────────────────────┐ │
│ │ 👤 田中さん        残り: 15分23秒 │ │ ← アクティブチャットカード
│ │ "こんにちは！"            未読:2 │ │   (緑色の発光)
│ └─────────────────────────────────┘ │
│ ┌─────────────────────────────────┐ │
│ │ 👤 佐藤さん        残り: 3分47秒  │ │   (オレンジ色の発光)
│ │ "写真ありがとうございます"  未読:0  │ │
│ └─────────────────────────────────┘ │
└─────────────────────────────────────┘
```
- **デザイン**:
    - **チャットカード**: `HomeView`の投稿カードと共通のガラスデザイン。
    - **アクティブ状態**: カードの縁が残り時間に応じて緑〜オレンジ〜赤に発光します。この光はネオンのようにぼんやりと輝きます。
    - **未読バッジ**: 未読メッセージがある場合、数字の入った水滴のような光沢のあるバッジが表示されます。

#### 3.3.2 機能仕様
- **データ取得**: `GET /chat/rooms` APIを呼び出し、アクティブなチャットと終了したチャットの一覧を取得します。
- **リアルタイム更新**: タイマーで1秒ごとに残り時間を更新し、カードの輝きを変化させます。
- **画面遷移**: `ChatListView` → `NavigationLink` → `ChatView`
    - トリガー: チャットカードタップ。

---

### 3.4 個別チャット画面 (ChatView)

#### 3.4.1 画面構成
```
┌─────────────────────────────────────┐
│ [←] 相手の名前                      │ ← ガラス調ヘッダー
├─────────────────────────────────────┤
│ 💧 19:30                            │ ← 液体状のタイマー
├─────────────────────────────────────┤
│                                     │
│  💬 メッセージ履歴エリア               │
│                                     │
├─────────────────────────────────────┤
│ 📷 [メッセージ入力] [送信]            │ ← ガラス調入力バー
└─────────────────────────────────────┘
```
- **デザイン**:
    - **ヘッダー**: 相手のプロフィール画像がぼやけて背景に表示され、その上にガラス調のヘッダーが重なります。
    - **カウントダウンタイマー**: 画面上部に配置された、液体が徐々に減っていくようなプログレスバーで表現。残り時間が少なくなると、液体が赤く変化します。
    - **メッセージバブル**:
        - **自分**: 鮮やかな青色の光沢があるガラスバブル。
        - **相手**: クールな紫色の光沢があるガラスバブル。
        - バブルは少し膨らんだ液体のような形状で、登場時にポンっと弾けるようなアニメーションをします。
    - **入力バー**: 半透明のガラスパネル。送信ボタンは光沢のある水滴デザイン。

#### 3.4.2 API/WebSocket連携
- **初期データ**: `GET /chat/rooms/{roomId}/messages` で過去のメッセージを取得。
- **リアルタイム通信**: `WebSocket`に接続し、メッセージの送受信、既読情報の更新を行います。
    - `sendMessage`: メッセージを送信。
    - `messageReceived`: 新規メッセージを受信。UIに流体アニメーションで追加します。

---

### 3.5 設定画面 (SettingsView)
- **デザイン**:
    - 現段階ではプレースホルダーとします。
    - 各設定項目は、タップすると波紋が広がるガラス調のリストアイテムとしてデザインします。

## 4. 画面遷移フロー図（改良版）

```
アプリ起動
    ↓
TabRootView
    ├── [ホーム] → HomeView
    │   ├── [投稿カード] → PostDetailView
    │   └── [新規投稿FAB] → CreatePostView (Sheet)
    │
    ├── [チャット] → ChatListView
    │   └── [チャットカード] → ChatView(roomId)
    │
    └── [設定] → SettingsView (プレースホルダー)
```

## 5. API連携（想定）

- **HomeView**: `GET /posts`
- **CreatePostView**: `POST /posts`
- **PostDetailView**: `POST /match/apply/{postId}`
- **ChatListView**: `GET /chat/rooms`
- **ChatView**: `GET /chat/rooms/{roomId}/messages`, WebSocket接続

---
*本書はLiquid Glassコンセプトに基づく初期設計であり、実装段階でアニメーションやデザインの微調整を行います。*
